{"version":3,"sources":["file:///mnt/vss/_work/1/s/dependencies/vscode/out-editor-src/vs/editor/standalone/browser/services/standaloneWebWorkerService.ts","vs/editor/standalone/browser/services/standaloneWebWorkerService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAE,oBAAoB,EAAE,MAAM,qCAAqC,CAAC;AAE3E,OAAO,EAAE,gBAAgB,EAAE,MAAM,gEAAgE,CAAC;AAElG,MAAM,OAAO,0BAA2B,SAAQ,gBAAgB;IAC5C,aAAa,CAAC,UAA+B;QAC/D,MAAM,iBAAiB,GAAG,oBAAoB,EAAE,CAAC;QACjD,IAAI,iBAAiB,EAAE,CAAC;YACvB,IAAI,OAAO,iBAAiB,CAAC,SAAS,KAAK,UAAU,EAAE,CAAC;gBACvD,MAAM,MAAM,GAAG,iBAAiB,CAAC,SAAS,CAAC,eAAe,EAAE,UAAU,CAAC,KAAK,CAAC,CAAC;gBAC9E,IAAI,MAAM,KAAK,SAAS,EAAE,CAAC;oBAC1B,OAAO,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;gBAChC,CAAC;YACF,CAAC;QACF,CAAC;QAED,OAAO,KAAK,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;IACxC,CAAC;IAEkB,mCAAmC,CAAC,UAA+B;QACrF,MAAM,WAAW,GAAG,aAAa,CAAC,CAAC,iDAAiD;QACpF,OAAO,2CAA2C,UAAU,CAAC,KAAK;sEACE,WAAW,sBAAsB,CAAC;IACvG,CAAC;IAEQ,YAAY,CAAC,UAA+B;QACpD,MAAM,iBAAiB,GAAG,oBAAoB,EAAE,CAAC;QACjD,IAAI,iBAAiB,EAAE,CAAC;YACvB,IAAI,OAAO,iBAAiB,CAAC,YAAY,KAAK,UAAU,EAAE,CAAC;gBAC1D,MAAM,SAAS,GAAG,iBAAiB,CAAC,YAAY,CAAC,eAAe,EAAE,UAAU,CAAC,KAAK,CAAC,CAAC;gBACpF,IAAI,SAAS,KAAK,SAAS,EAAE,CAAC;oBAC7B,MAAM,WAAW,GAAG,IAAI,GAAG,CAAC,SAAS,EAAE,QAAQ,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,CAAC;oBACpE,OAAO,WAAW,CAAC;gBACpB,CAAC;YACF,CAAC;QACF,CAAC;QAED,IAAI,CAAC,UAAU,CAAC,wBAAwB,EAAE,CAAC;YAC1C,MAAM,IAAI,KAAK,CAAC,kHAAkH,UAAU,CAAC,KAAK,EAAE,CAAC,CAAC;QACvJ,CAAC;QAED,MAAM,GAAG,GAAG,OAAO,UAAU,CAAC,wBAAwB,KAAK,UAAU,CAAC,CAAC,CAAC,UAAU,CAAC,wBAAwB,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC,wBAAwB,CAAC;QACpJ,MAAM,MAAM,GAAG,GAAG,CAAC,QAAQ,EAAE,CAAC;QAC9B,OAAO,MAAM,CAAC;IACf,CAAC;CACD","file":"standaloneWebWorkerService.js","sourceRoot":"file:///mnt/vss/_work/1/s/dependencies/vscode/out-editor-src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getMonacoEnvironment } from '../../../../base/browser/browser.js';\nimport { WebWorkerDescriptor } from '../../../../platform/webWorker/browser/webWorkerDescriptor.js';\nimport { WebWorkerService } from '../../../../platform/webWorker/browser/webWorkerServiceImpl.js';\n\nexport class StandaloneWebWorkerService extends WebWorkerService {\n\tprotected override _createWorker(descriptor: WebWorkerDescriptor): Promise<Worker> {\n\t\tconst monacoEnvironment = getMonacoEnvironment();\n\t\tif (monacoEnvironment) {\n\t\t\tif (typeof monacoEnvironment.getWorker === 'function') {\n\t\t\t\tconst worker = monacoEnvironment.getWorker('workerMain.js', descriptor.label);\n\t\t\t\tif (worker !== undefined) {\n\t\t\t\t\treturn Promise.resolve(worker);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn super._createWorker(descriptor);\n\t}\n\n\tprotected override _getWorkerLoadingFailedErrorMessage(descriptor: WebWorkerDescriptor): string | undefined {\n\t\tconst examplePath = '\\'...?esm\\''; // Broken up to avoid detection by bundler plugin\n\t\treturn `Failed to load worker script for label: ${descriptor.label}.\nEnsure your bundler properly bundles modules referenced by \"new URL(${examplePath}, import.meta.url)\".`;\n\t}\n\n\toverride getWorkerUrl(descriptor: WebWorkerDescriptor): string {\n\t\tconst monacoEnvironment = getMonacoEnvironment();\n\t\tif (monacoEnvironment) {\n\t\t\tif (typeof monacoEnvironment.getWorkerUrl === 'function') {\n\t\t\t\tconst workerUrl = monacoEnvironment.getWorkerUrl('workerMain.js', descriptor.label);\n\t\t\t\tif (workerUrl !== undefined) {\n\t\t\t\t\tconst absoluteUrl = new URL(workerUrl, document.baseURI).toString();\n\t\t\t\t\treturn absoluteUrl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!descriptor.esmModuleLocationBundler) {\n\t\t\tthrow new Error(`You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker for the worker label: ${descriptor.label}`);\n\t\t}\n\n\t\tconst url = typeof descriptor.esmModuleLocationBundler === 'function' ? descriptor.esmModuleLocationBundler() : descriptor.esmModuleLocationBundler;\n\t\tconst urlStr = url.toString();\n\t\treturn urlStr;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getMonacoEnvironment } from '../../../../base/browser/browser.js';\nimport { WebWorkerDescriptor } from '../../../../platform/webWorker/browser/webWorkerDescriptor.js';\nimport { WebWorkerService } from '../../../../platform/webWorker/browser/webWorkerServiceImpl.js';\n\nexport class StandaloneWebWorkerService extends WebWorkerService {\n\tprotected override _createWorker(descriptor: WebWorkerDescriptor): Promise<Worker> {\n\t\tconst monacoEnvironment = getMonacoEnvironment();\n\t\tif (monacoEnvironment) {\n\t\t\tif (typeof monacoEnvironment.getWorker === 'function') {\n\t\t\t\tconst worker = monacoEnvironment.getWorker('workerMain.js', descriptor.label);\n\t\t\t\tif (worker !== undefined) {\n\t\t\t\t\treturn Promise.resolve(worker);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn super._createWorker(descriptor);\n\t}\n\n\tprotected override _getWorkerLoadingFailedErrorMessage(descriptor: WebWorkerDescriptor): string | undefined {\n\t\tconst examplePath = '\\'...?esm\\''; // Broken up to avoid detection by bundler plugin\n\t\treturn `Failed to load worker script for label: ${descriptor.label}.\nEnsure your bundler properly bundles modules referenced by \"new URL(${examplePath}, import.meta.url)\".`;\n\t}\n\n\toverride getWorkerUrl(descriptor: WebWorkerDescriptor): string {\n\t\tconst monacoEnvironment = getMonacoEnvironment();\n\t\tif (monacoEnvironment) {\n\t\t\tif (typeof monacoEnvironment.getWorkerUrl === 'function') {\n\t\t\t\tconst workerUrl = monacoEnvironment.getWorkerUrl('workerMain.js', descriptor.label);\n\t\t\t\tif (workerUrl !== undefined) {\n\t\t\t\t\tconst absoluteUrl = new URL(workerUrl, document.baseURI).toString();\n\t\t\t\t\treturn absoluteUrl;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!descriptor.esmModuleLocationBundler) {\n\t\t\tthrow new Error(`You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker for the worker label: ${descriptor.label}`);\n\t\t}\n\n\t\tconst url = typeof descriptor.esmModuleLocationBundler === 'function' ? descriptor.esmModuleLocationBundler() : descriptor.esmModuleLocationBundler;\n\t\tconst urlStr = url.toString();\n\t\treturn urlStr;\n\t}\n}\n"]}