import { Channel, IRequestHandler, IRequestSender, RequestObject, ResponseObject } from "./Channel";
import { RequestId } from "./JsonRpcTypes";
import { RpcLogger } from "./Logger";
import { ConnectionState, IMessageTransport } from "./MessageTransport";
import { IValueWithChangeEvent } from "./common";
/**
 * Implements a channel through a stream and an optional request handler to handle incoming requests.
 */
export declare class StreamBasedChannel implements IRequestSender {
    private readonly _stream;
    private readonly _listener;
    private readonly _logger;
    /**
     * Creates a channel factory from a given stream and logger.
     * This allows to delay specifying a `RequestHandler`.
     * Once the channel is created, it processes incoming messages.
     */
    static createChannel(stream: IMessageTransport, logger: RpcLogger | undefined): Channel;
    private readonly _unprocessedResponses;
    private _lastUsedRequestId;
    constructor(_stream: IMessageTransport, _listener: IRequestHandler | undefined, _logger: RpcLogger | undefined);
    get state(): IValueWithChangeEvent<ConnectionState>;
    private _processNotification;
    private _processRequest;
    private _processResponse;
    private _newRequestId;
    sendRequest(request: RequestObject, _context: void, messageIdCallback?: (requestId: RequestId) => void): Promise<ResponseObject>;
    sendNotification(notification: RequestObject, context: void): Promise<void>;
    toString(): string;
}
//# sourceMappingURL=StreamBasedChannel.d.ts.map